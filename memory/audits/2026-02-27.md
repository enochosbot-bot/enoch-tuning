# Security Audit — 2026-02-27

**Auditor:** Gideon (Nightly Deep Audit)
**Time:** 03:30 CST
**Grade: B+**
**Perspectives:** Offensive · Defensive · Data Privacy · Operational Realism

---

## Summary
No CRITICAL findings. macOS upgraded to 26.3 and Tailscale is now connected — two open remediations from prior audits resolved. Top finding: OpenClaw Homebrew cask flagged as deprecated (Gatekeeper failure) with hard disable date of 2026-09-01, and the installed version is 2 minor releases behind latest. 24 API secrets live in plaintext environment; attack surface unchanged. 11 Homebrew packages and 7 npm globals outdated.

---

## Findings

### HIGH — OpenClaw Homebrew Cask Deprecated (Gatekeeper Failure)
**Evidence:** `brew info openclaw` → "Deprecated because it does not pass the macOS Gatekeeper check! It will be disabled on 2026-09-01." Installed: 2026.2.24. Latest: 2026.2.26.
**Risk:** Brew will stop tracking and eventually refuse to manage this cask. If not resolved, upgrading via brew is blocked. 2026-09-01 = 187 days. Gatekeeper non-compliance also means the binary isn't notarized — Apple could block it on OS update. Two versions behind latest.
**Fix:** `npm install -g openclaw` to get 2026.2.26 (npm path bypasses brew cask). Long-term: OpenClaw team needs to re-notarize or switch distribution to npm-only. Track at https://github.com/openclaw/openclaw.
**Perspective:** Offensive — unnotarized binary is a target for supply chain substitution.

---

### MEDIUM — 24 API Secrets in Plaintext ~/.zshrc
**Evidence:** `grep -c "API_KEY\|TOKEN\|SECRET" ~/.zshrc` → 24. Keys include ANTHROPIC, OPENAI, XAI, TELEGRAM_BOT_TOKEN, DISCORD_BOT_TOKEN, X_BEARER_TOKEN, X_OAUTH_CLIENT_SECRET, YOUTUBE_API_KEY, NETLIFY_API_TOKEN, MOONSHOT_API_KEY, KIMI_API_KEY, plus 13 others. All visible to any process running as current user.
**Risk:** 3 new keys added since last audit (X_OAUTH_CLIENT_ID/SECRET, X_API_KEY_ENOCH, YOUTUBE_API_KEY, NETLIFY_API_TOKEN). Key count grew from ~15 to 24. Any local process, any injected script, any cron with access to the shell env can read all of them. If ~/.zshrc is ever committed to a repo or synced to a cloud service, all 24 keys rotate instantly.
**Fix:** Migrate to `op run` (1Password CLI). Priority order: TELEGRAM_BOT_TOKEN (highest blast radius), ANTHROPIC_API_KEY, X_OAUTH_CLIENT_SECRET, OPENAI_API_KEY. Short term: `chmod 600 ~/.zshrc`.
**Perspective:** Data Privacy — Telegram bot token grants full bot control, Anthropic API key has billing exposure.

---

### MEDIUM — 11 Homebrew Packages Outdated (Security-Relevant)
**Evidence:** `brew outdated` → agent-browser, oven-sh/bun/bun, certifi, deno, gemini-cli, gh, libngtcp2, ollama, sheeki03/tap/tirith, uv, openclaw.
**Risk:** `libngtcp2` is an HTTP/3 QUIC implementation — CVEs in this class tend to be high severity. `certifi` is a CA cert bundle — stale means potentially missing revocations. `gh` and `ollama` are network-facing. `tirith` is the terminal security guard — if it's outdated, it may miss new attack patterns.
**Fix:** `brew upgrade` (check for restart requirements first). Prioritize: certifi, libngtcp2, tirith, gh. `brew upgrade certifi libngtcp2 sheeki03/tap/tirith gh` first, then full upgrade.
**Perspective:** Defensive — libngtcp2 and certifi are direct security components.

---

### MEDIUM — 7 npm Global Packages Outdated
**Evidence:** `npm -g outdated` → openclaw 2026.2.24→2026.2.26, netlify-cli 23.15.1→24.0.1, wrangler 4.68.0→4.69.0, npm 11.9.0→11.11.0, @bankr/cli 0.1.0-beta.16→0.1.0-beta.18, pnpm 10.30.1→10.30.3.
**Risk:** netlify-cli and wrangler are deployment tools — outdated versions can have auth token handling bugs. npm itself is 2 minor versions behind. openclaw npm package is same gap as cask.
**Fix:** `npm -g update openclaw netlify-cli wrangler npm`
**Perspective:** Operational Realism — stale deploy tools can cause silent failures or behavior drift.

---

### MEDIUM — 5 Stale .bak Plists in ~/Library/LaunchAgents
**Evidence:** `ls ~/Library/LaunchAgents/*.bak*` → 5 files dating back to 2026-02-22. Names: bak-20260222-093211, bak-20260223-fix, bak-manual-20260225-125937, bak-secret-hygiene-20260226, bak-service-repair-20260226-071448.
**Risk:** LaunchD scans this directory. Stale plists don't load (wrong extension) but create noise and make auditing harder. Offensive vector: if an attacker can write to ~/Library/LaunchAgents/, a .bak file renamed to .plist is instant persistence.
**Fix:** `mkdir ~/Library/LaunchAgents/archive && mv ~/Library/LaunchAgents/*.bak* ~/Library/LaunchAgents/archive/`
**Perspective:** Offensive — directory pollution obscures legitimate agent changes.

---

### MEDIUM — LaunchAgent Count Grew (Now 9 Active + 5 Bak)
**Evidence:** Active plists: ai.openclaw.gateway, ai.openclaw.node, com.clawfeed.server, com.openclaw.github-release-watcher, com.openclaw.identity-watcher, com.openclaw.nosleep, com.openclaw.secret-scrub, com.openclaw.watchdog, homebrew.mxcl.ollama. 9 active agents vs ~5 at last audit.
**Risk:** Each agent is a potential persistence vector and a process that runs with user privileges. Clawfeed, identity-watcher, and github-release-watcher are new since last audit — purpose not fully documented.
**Fix:** Audit each new agent's script path and StartInterval. Confirm clawfeed and identity-watcher are still needed.
**Perspective:** Offensive — unknown persistent processes are first-class audit targets.

---

### LOW — ops/morning-brief-data.md and 2 Other Files Untracked in Git
**Evidence:** `git status` → `?? ops/morning-brief-data.md`, `?? shared-context/feedback/reflection-2026-02-27.md`. Also `shared-context/backlog.md` modified but not staged.
**Risk:** Untracked files don't get auto-committed. Daily data can be lost on disk failure. morning-brief-data.md is an ops-critical file.
**Fix:** Add to git and commit: `git add ops/morning-brief-data.md shared-context/ && git commit -m "chore: track ops files"`
**Perspective:** Operational Realism — if this machine dies, untracked files are gone.

---

### LOW — Screensharing Daemon Loaded (On-Demand)
**Evidence:** `launchctl list | grep screensharing` → `com.apple.screensharing.agent` loaded (PID -). No port 5900 listener. ARD kickstart → "No options selected."
**Risk:** Daemon is ready to fire on-demand. Not actively listening. With Tailscale running, the VNC attack surface is now on the Tailnet. Low risk if Tailscale ACLs restrict who can connect.
**Fix:** Verify Tailscale ACLs restrict port 5900 to known nodes only. No immediate action required.
**Perspective:** Defensive — acceptable, but confirm Tailscale ACL scope.

---

### LOW — Docker LaunchDaemons Always Loaded
**Evidence:** `/Library/LaunchDaemons/com.docker.socket.plist`, `com.docker.vmnetd.plist`. Docker Server Version 29.2.0. No port 2375 or 2376 listener (TLS disabled / socket only — clean).
**Risk:** vmnetd runs as root. Known Docker Desktop privilege escalation vectors exist in older versions. 29.2.0 is current.
**Fix:** Monitor for Docker Desktop updates. Acceptable posture.
**Perspective:** Offensive — root daemon, but version is current and socket-only.

---

## Resolved Since Last Audit (2026-02-15)

| Item | Prior Status | Now | Change |
|------|-------------|-----|--------|
| macOS version | 15.6 (7+ days unpatched) | 26.3 (Tahoe) | ✅ Major upgrade complete |
| Tailscale | Installed, not connected | Connected (100.124.44.74) | ✅ Secure remote access live |
| OpenClaw brew/npm sync | Version mismatch | Still mismatched (new gap) | ⚠️ New gap opened |
| ngrok | Dead | Dead | ✅ Holding |

---

## Clean Checks
- ✅ No ngrok, cloudflared, frp, bore, or localtunnel processes
- ✅ FileVault On
- ✅ SIP enabled
- ✅ Firewall enabled (State = 1)
- ✅ No listening TCP/UDP ports exposed (lsof clean)
- ✅ Tailscale connected (100.124.44.74)
- ✅ No Docker ports 2375/2376 exposed (socket-only)
- ✅ No Ollama port 11434 exposed externally
- ✅ Secret scrub cron ran successfully (2026-02-26 log present)
- ✅ No API keys found in logs (secret scrub clean)
- ✅ Workspace git auto-backup running (last: 2026-02-27 00:01)
- ✅ 3 .bak files for gateway plist (prior audit's extra ones still present — see finding #4)
- ✅ macOS 26.3 — no pending updates observed (softwareupdate not available in exec env)

---

## Delivery Note
`cron-delivery-check.py` not found at scripts path (exit 2). Script does not exist — likely never created. `daily-prompt.md` for observer agent also missing (found AGENT_PROMPT.md instead). These are infrastructure gaps, not security findings.

---

**Letter Grade: B+**
**Top Finding: OpenClaw Homebrew cask deprecated (Gatekeeper failure) — hard disable date 2026-09-01.**
