# Security Audit — 2026-02-27

**Auditor:** Arnold (Oracle) — Abaddon Mode  
**Time:** 03:45 CST  
**Host:** Deacon's Mac mini (Darwin 25.3.0, macOS 26.3 arm64)  
**Grade:** B

---

## Summary

No critical breach indicators found. Two persistent medium-severity issues remain unfixed from prior audits: `/opt/homebrew/bin` group-writable (supply-chain risk) and `openclaw.json` world-readable (no credentials exposed currently, but permissions are incorrect). System defenses are solid — SIP on, FileVault on, Firewall+stealth on, gateway loopback-only.

---

## Findings

### MEDIUM — /opt/homebrew/bin group-writable
**Evidence:** `ls -la /opt/homebrew/bin` → `drwxr-xr-x` with owner `deaconsopenclaw admin`. exec-audit.log shows 50+ warnings in 24h: `safeBinTrustedDirs includes group-writable directory '/opt/homebrew/bin'`  
**Risk:** Any process running as admin group can drop malicious binaries into `/opt/homebrew/bin`, which is in PATH and trusted by OpenClaw. Supply-chain attack vector.  
**Fix:** `chmod 755 /opt/homebrew/bin` (should already be 755; verify with `ls -la /opt/homebrew/` — the issue may be the parent dir or OpenClaw config trust setting)

### MEDIUM — openclaw.json world-readable
**Evidence:** `-rw-r--r--@ 1 deaconsopenclaw staff 34363 Feb 26 22:20 /Users/deaconsopenclaw/.openclaw/openclaw.json`  
**Risk:** Any local user or compromised process can read full OpenClaw config. No raw credential patterns found in file (no sk-, xai-, ghp_ etc), but config structure, agent configs, and routing details are exposed.  
**Fix:** `chmod 600 ~/.openclaw/openclaw.json`

### MEDIUM — Elevated exec logged: API key enumeration
**Evidence:** exec-audit.log `[2026-02-26 02:54:23 CST] elevated command env | grep -i openai | grep -i key | head -3; env | grep...`  
**Risk:** An agent ran an elevated command to grep for API keys in the process environment. Legitimate audit behavior — but elevated env-dump commands are worth flagging for review.  
**Action:** Review which agent triggered this. If not intentional audit, treat as anomaly.

### LOW — World-readable AGENTS files in /tmp
**Evidence:** `-rw-r--r-- 1 deaconsopenclaw wheel 6159 Feb 23 AGENTS.v2.full.md` and `AGENTS.v2.md` in `/tmp/`  
**Risk:** Agent configuration/context leaked to world-readable temp space. Anyone reading /tmp on this machine can see agent architecture.  
**Fix:** `rm /tmp/AGENTS.v2*.md` — these appear to be stale staging files.

### LOW — SSH public key world-readable
**Evidence:** `-rw-r--r--@ 1 deaconsopenclaw staff 125 Feb 22 00:45 id_ed25519.pub`  
**Risk:** Public keys are intended to be readable — this is expected. Noting for completeness.  
**Action:** None required.

### INFO — Tailscale active, MacBook offline 5min
**Evidence:** `tailscale status`: Mini at 100.124.44.74 online; MacBook Pro at 100.90.126.71 offline (last seen 5m ago)  
**Risk:** Tailscale creates a mesh tunnel between devices. No current exposure since MacBook is offline, but this is a network path worth monitoring.  
**Action:** Confirm Tailscale ACLs restrict access to only trusted devices.

---

## No Issues (Passed Clean)

- **SIP:** Enabled ✅
- **FileVault:** On ✅
- **Firewall:** Enabled + stealth mode on ✅
- **Gateway bind:** loopback 127.0.0.1:49297 only ✅
- **SSH authorized_keys:** Empty (no unauthorized keys) ✅
- **Crontab:** Empty ✅
- **Tunnels:** No ngrok/frp/cloudflared/bore processes ✅
- **Credential patterns in openclaw.json:** None found ✅
- **Credentials directory:** All files 600 (owner-only) ✅
- **LaunchAgents:** All 600 permissions, known services only ✅
- **Identity change audit:** Normal config file changes, no anomalies ✅
- **TCP/UDP listeners:** None detected externally ✅
- **No world-readable secrets in .openclaw/credentials/:** Confirmed ✅

---

## Drift vs Prior Audit

- `/opt/homebrew/bin` group-writable warning: persistent, not remediated
- `openclaw.json` world-readable: still unchanged from prior audit
- No new LaunchAgents since last scan
- Secret-scrub LaunchAgent installed 2026-02-26 — good addition

---

## Grade Rationale

**B** — Fundamentals are strong (SIP, FileVault, Firewall, no exposed ports, clean credentials dir). Downgraded from A due to two persistent unfixed medium issues (/opt/homebrew/bin permissions and openclaw.json world-readable) and the API-key grep from an elevated agent command that warrants review.
