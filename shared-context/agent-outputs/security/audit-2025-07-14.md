# Security Audit — 2026-02-14

## Summary
Active ngrok tunnel exposing port 3334 to the public internet. Three pending macOS updates including a point release. System hardening is solid otherwise.

## Findings

### HIGH — Active ngrok Tunnel Exposing Local Service
**Evidence:** `ngrok http 3334` running (PID 24831). Public URL: `https://nonrationally-unexplorable-roxie.ngrok-free.dev` → `http://localhost:3334`. 35 connections served. Port 3334 is the OpenClaw gateway browser control port.
**Risk:** Anyone with the ngrok URL can reach the local service. If auth is weak or absent on port 3334, full gateway access is possible.
**Fix:** Kill if unneeded: `kill 24831`. If needed, verify authentication is enforced on the tunnel endpoint. Consider `ngrok http 3334 --basic-auth="user:pass"`.

### MEDIUM — macOS Updates Pending (Including Point Release)
**Evidence:** `softwareupdate -l` shows: macOS 15.7.4 (restart required), Safari 26.3, Xcode CLI Tools 26.2. Current: macOS 15.6.
**Risk:** Missing security patches. macOS point releases typically include CVE fixes.
**Fix:** `sudo softwareupdate -ia --restart` (schedule during downtime).

### MEDIUM — Homebrew/npm Packages Outdated
**Evidence:** `brew outdated`: llhttp. `npm -g outdated`: clawhub 0.6.0→0.6.1, npm 11.9.0→11.10.0.
**Risk:** Outdated packages may contain known vulnerabilities.
**Fix:** `brew upgrade && npm -g update`

### LOW — OpenClaw Gateway Not Installed as LaunchAgent
**Evidence:** `openclaw gateway status` reports "Service not installed" and recommends `openclaw gateway install`. Gateway is running manually from terminal (PID 38623).
**Risk:** Gateway won't auto-restart on reboot. Manual process could be accidentally terminated.
**Fix:** `openclaw gateway install`

### LOW — Unauthorized WebSocket Connection Attempts in Logs
**Evidence:** Gateway logs show repeated `device_token_mismatch` rejections from `127.0.0.1` via `openclaw-control-ui webchat`. Multiple attempts at 22:14–22:15 UTC.
**Risk:** Likely stale browser tab with old token. Low risk since auth correctly rejected the connection. Could indicate token rotation issue.
**Fix:** Clear browser cache for `127.0.0.1:18789` or rotate device token.

### LOW — API Keys in Environment Variables
**Evidence:** `env` shows: MOONSHOT_API_KEY, KIMI_API_KEY, GEMINI_API_KEY, SYNTHDATA_API_KEY (values redacted). These are visible to any process running as the current user.
**Risk:** Any local process or malware running as this user can read these keys. Combined with the ngrok tunnel, lateral movement risk increases.
**Fix:** Consider using a secrets manager or `.env` files with restricted permissions instead of shell-wide exports.

## No Issues
- ✅ Firewall enabled (State = 1)
- ✅ SIP enabled
- ✅ FileVault On
- ✅ Gatekeeper enabled (assessments enabled)
- ✅ All listening ports bound to 127.0.0.1 (localhost only) — Ollama 11434, ngrok 4040, OpenClaw 18789/18792/3334
- ✅ No SSH/Remote Login detected (ssh-agent only, no sshd)
- ✅ No zombie processes
- ✅ DNS config normal (local router + IPv6)
- ✅ Node.js v25.6.1 (current)
- ✅ XProtect v5329, MRT v1.93, XProtect Payloads v156 (present)
- ✅ Workspace permissions standard (owner rw, group/other r)
- ✅ No API keys found hardcoded in gateway logs
- ✅ Gateway bound to loopback only (127.0.0.1:18789)
